#!/bin/bash

# Install Homebrew
if [ ! "$(which brew)" ]; then
  /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
fi

# Sudo without password
sudo sed -i '' 's/^%admin.*/%admin          ALL = (ALL) NOPASSWD:ALL/' /etc/sudoers

CASKS=$(brew cask ls)

function has_cask () {
  echo "${CASKS}" | grep --quiet --line-regexp --fixed-strings "$1"
}

function cask_install () {
  for cask in "$@"; do
    printf "Installing cask $cask..."
    has_cask "$cask" || {
      brew cask install $cask
      APP=`brew cask info $cask | grep \(App\) | cut -f1 -d'.'`
      test ! -z "$APP" && xattr -dr com.apple.quarantine "/Applications/$APP.app"
    }
    echo ✔︎
  done
}

# Developer tools
cask_install docker

# Applications
cask_install whatsapp slack 1password


printf "\n\n--== REMEMBER to use: \`sudo trimforce enable\` if using a 3rd-party SSD ==--\n\n"
